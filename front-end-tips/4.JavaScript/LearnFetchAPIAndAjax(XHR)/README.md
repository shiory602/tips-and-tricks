# Fetch API
> ES2015以降に導入されたPromise（非同期処理）をベースに設計された機能
ここでの「非同期処理」はAjaxのような「ページを遷移しない」という意味ではない。
> 必要に応じていつでもサーバへリクエストを送信し新しい情報を読み込む
> ページをリロードすることなく行う

1. APIの実行
2. 通信が成功した時と失敗した時のコールバック関数の設定
```js
// Fetch APIの実行
// fetch で GET の HTTPリクエストを行う -> fetchメソッド は Promiseインスタンス を返す
const userId = "任意のGitHubユーザーID";

function fetchUserInfo(userId) {
  fetch(`https://api.github.com/users/${encodeURIComponent(userId)}`)
    // 通信が成功したとき
    // Promiseインスタンス は Responseオブジェクト で resolve され、 thenコールバック が呼び出される
    .then(response => {
        // Responseオブジェクト の statusプロパティ からは HTTPレスポンス のステータスコードが取得できる
        console.log(response.status); // => 200
        // エラーレスポンスが返されたことを検知する
        if (!response.ok) {
          console.error("エラーレスポンス", response);
        } else {
          // Responseオブジェクト の jsonメソッドも Promise を返す
          // HTTPレスポンスボディ を JSON としてパースしたオブジェクトでresolveされる
          return response.json().then(userInfo => {
              // JSONパース*1されたオブジェクトが渡される
              console.log(userInfo); // => {...}
          });
        }
    // 通信が失敗したとき
    // エラーハンドリングを thenメソッド の第二引数か catchメソッド のコールバック関数 で行う
    }).catch(error => {
        console.error(error);
  });
}
```
*1: 自分の環境で扱えるように解析、変換することをparseという
JSONファイルはそのまま読み込めばただの**文字列**だが、これらをJavaScriptのオブジェクトとして扱いたい。つまりJSONとして扱いたい場合、適切にパースすることによって、JSONとして扱うことができる。

## Promise
JavaScriptでは多くの処理が非同期のため、処理が終わったことを知らせるためにコールバックが有効。
しかしコールバックを使いすぎると入れ子上になってコールバック地獄になってしまう。
これを解決するのに使われるのが**Promise**である。

## Promiseチェーン
Promiseではメソッドを次々に`.`で繋いで呼び出す「メソッドチェーン」と言う仕組みを利用している。
Promiseでは`.then(res => {...})`をいくつも繋いで書くことができ、これを「Promiseチェーン」と言う



***

# Ajax(XHR)
“AJAX” (Asynchronous Javascript And Xml) = XMLHttpRequest
Ajaxとは、JavaScriptでサーバー側との通信を**非同期**で行い、通信結果によって**動的にページの一部だけ書き換える手法**のこと。
JavaScript以外にもXMLやXMLHttpRequest、DOMなど**既存の機能**を組み合わせて実現する。

### XMLHttpRequest
> クライアントとサーバーの間でデータを伝送するための機能をクライアント側で提供する API です。
> ページ全体を再読み込みすることなく、URLからデータを読み出す簡単な方法を提供します。
> このAPIによって、ユーザの作業を中断させることなくWebページの一部を更新することができます。
> (MDNより)

### JavaScript
XMLHttpRequestはjavascriptの組み込みオブジェクトであり、あらかじめ定義されている。
つまり、非同期通信はjavascriptを使わないと実装できない。

### DOM
> Document Object Model (DOM) は、HTML および XML ドキュメントのための API です。これはドキュメントの構造的な表現を提供し、内容や表示形態の変更を可能にします。端的に言えば、Web ページをスクリプトやプログラミング言語とつなぐような機構です。
> (MDNより）
Ajaxを使って動的なWebページを作成するときに、HTML・XML上のどの要素を変更するかを指定する。そこでDOMはHTMLやXMLを「ツリー構造」として展開し、アプリケーション側に文章の情報を伝え、加工や変更をしやすくする。

### XML
Extensible Markup Languageの略。
文書やデータの意味や構造を記述するためのマークアップ言語の一つ（HTMLと似たようなもの)


***


以下の動作を画面遷移なしで行うことができる！！
1. サーバー側との通信：ページの再読み込みなしにサーバーにリクエストを送信しサーバーからのレスポンスを待つ間に別の処理を行う
2. データ交換：「足りていない部分 = 更新に必要な一部の情報」をサーバーにリクエストして受け取り、その一部の情報を書き換えて表示
3. ページの更新

例に挙げるとGoogleMapなどがある。

## 同期通信と非同期崇信の違い
同期通信の動画は、探したい場所を検索すると一瞬ページ全体が真っ白になってから表示される。
一方で非同期通信の動画は、探したい場所をカーソルで移動するとページの再読み込みすることなく移動先の地図が表示される。

### 同期通信
同期通信は、送信と受信のタイミングを合わせた通信方式のこと
1. ページが再読み込みされる
2. リクエストからレスポンスの１往復が終わらないと、次のリクエストは送信できないため、１つの処理が終わるまで他の操作できない
3. ページ全体を１から作成して表示しているため、クライアントは、リクエストしてからレスポンスが返るまで待機状態になる

### 非同期通信
非同期通真は、送信と受信のタイミングをずらした通信方式のこと
1. ページの再読み込みがなく、レスポンス待ちでも別の操作をする事が出来る
2. リクエストからレスポンスの１往復が終わらなくても、次のリクエストは送信する事ができるため、１つの処理が終わるまで待たずに他の操作をする事が出来る




***
参照：
[【JavaScript基礎】Fetch APIの基礎](https://kde.hateblo.jp/entry/2018/10/22/010811),
[初心者目線でAjaxの説明](https://qiita.com/hisamura333/items/e3ea6ae549eb09b7efb9),
[JAVASCRIPT.INFO](https://ja.javascript.info/network)